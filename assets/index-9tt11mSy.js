import{l as w,d as T,s as L,a as V,F as D,b as F,S as M,t as H,y as l,L as $,D as U,c as k,e as f,q as K}from"./vendor-tJNv_qKg.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();const Y="modulepreload",X=function(e){return"/magawa/"+e},b={},u=function(t,s,o){let n=Promise.resolve();if(s&&s.length>0){const r=document.getElementsByTagName("link");n=Promise.all(s.map(i=>{if(i=X(i),i in b)return;b[i]=!0;const c=i.endsWith(".css"),O=c?'[rel="stylesheet"]':"";if(!!o)for(let h=r.length-1;h>=0;h--){const m=r[h];if(m.href===i&&(!c||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${O}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Y,c||(d.as="script",d.crossOrigin=""),d.href=i,document.head.appendChild(d),c)return new Promise((h,m)=>{d.addEventListener("load",h),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${i}`)))})}))}return n.then(()=>t()).catch(r=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=r,window.dispatchEvent(i),!i.defaultPrevented)throw r})};var _=(e=>(e.Home="/",e.Game="/game",e.Highscores="/highscores",e.About="/about",e))(_||{}),E=(e=>(e[e.Easy=0]="Easy",e[e.Medium=1]="Medium",e[e.Hard=2]="Hard",e[e.Custom=3]="Custom",e))(E||{});const C=1,S={0:{tilesX:8,tilesY:8,minesCount:10},1:{tilesX:16,tilesY:16,minesCount:40},2:{tilesX:30,tilesY:16,minesCount:99},3:{tilesX:30,tilesY:24,minesCount:668}};var a=(e=>(e[e.Closed=0]="Closed",e[e.Running=1]="Running",e[e.Paused=2]="Paused",e[e.Finished=3]="Finished",e))(a||{}),A=(e=>(e[e.Lost=0]="Lost",e[e.Won=1]="Won",e))(A||{});const p=1,y="magawa";class N{data;dataKey=`${y}_data`;versionKey=`${y}_dataVersion`;constructor(){this.verifyDataVersion(),this.read()}set(t){this.data={...this.data,...t},this.write()}get(t){return{...t,...this.data}}read(){let t;try{t=JSON.parse(w.decompressFromUTF16(window.localStorage.getItem(this.dataKey)||""))}catch{t={...this.data}}this.data=t}write(){window.localStorage.setItem(this.dataKey,w.compressToUTF16(JSON.stringify(this.data||{}))),window.localStorage.setItem(this.versionKey,JSON.stringify(`${p}`))}verifyDataVersion(){let t;try{t=Number.parseInt(JSON.parse(window.localStorage.getItem(this.versionKey)||`${p}`),10)}catch{t=p}t!==p&&(window.localStorage.removeItem(this.dataKey),window.localStorage.removeItem(this.versionKey))}}const I=new N;var g=(e=>(e.SetSettings="setSettings",e.Start="start",e.FirstClick="firstClick",e.Restart="restart",e.Pause="pause",e.Unpause="unpause",e.TogglePause="togglePause",e.Finish="finish",e.Close="close",e.SetFlagsCount="setFlagsCount",e))(g||{});const x={setSettings:({player:e,difficulty:t,settings:s})=>o=>{if(!/^\w+$/.test(e))return o;t=t>=0&&t<=E.Custom?t:o.difficulty;const n=t===E.Custom?s||{tilesX:o.tilesX,tilesY:o.tilesY,minesCount:o.minesCount}:S[t],{tilesX:r,tilesY:i,minesCount:c}=n;return I.set({player:e,difficulty:t,difficultySettings:n}),{...o,player:e,difficulty:t,tilesX:r,tilesY:i,minesCount:c}},start:()=>({status:a.Running,finalStatus:null,startedAt:null,pausedAt:null,finishedAt:null,flagsCount:0}),firstClick:()=>({startedAt:new Date,pausedAt:null,finishedAt:null,flagsCount:0}),pause:()=>e=>e.status!==a.Running?e:{...e,status:a.Paused,pausedAt:new Date},unpause:()=>e=>{if(e.status!==a.Paused)return e;const t=T(e.pausedAt,new Date),s=e.startedAt?L(e.startedAt,t):null;return{...e,status:a.Running,startedAt:s,pausedAt:null}},finish:({finalStatus:e})=>t=>t.status!==a.Running?t:{...t,finishedAt:new Date,status:a.Finished,finalStatus:e},close:()=>({status:a.Closed,startedAt:null,pausedAt:null}),setFlagsCount:({flagsCount:e})=>t=>t.status!==a.Running||typeof e!="number"?t:{...t,flagsCount:e}},W={player:({player:e})=>e,isRunning:({status:e})=>e===a.Running,isPaused:({status:e})=>e===a.Paused,isFinished:({status:e})=>e===a.Finished,isClosed:({status:e})=>e===a.Closed,isWon:({finalStatus:e})=>e===A.Won,width:({tileSize:e,tilesX:t})=>e*t},j={[g.Restart]:(e,t,s)=>{s(g.Start)},[g.TogglePause]:(e,t,s)=>{W.isPaused(t)?s(g.Unpause):s(g.Pause)}},{player:q,difficulty:B,difficultySettings:{tilesX:J,tilesY:z,minesCount:Q}}=I.get({player:null,difficulty:C,difficultySettings:S[C]}),R={player:q,status:a.Closed,finalStatus:null,startedAt:null,pausedAt:null,finishedAt:null,difficulty:B,tileSize:40,tilesX:J,tilesY:z,minesCount:Q,flagsCount:0},Z=new V(R,x,j),G=D(R),ee=f(()=>u(()=>import("./game-view-ntBVl9sU.js"),__vite__mapDeps([0,1,2,3])).then(e=>e.GameView)),te=f(()=>u(()=>import("./highscores-view-A4Zq-Rs2.js"),__vite__mapDeps([4,1,2,3])).then(e=>e.HighscoresView)),se=f(()=>u(()=>import("./about-view-9X0Thvtk.js"),__vite__mapDeps([5,1,3])).then(e=>e.AboutView)),ne=f(()=>u(()=>import("./menu-view-x9p04cmp.js"),__vite__mapDeps([6,1,3])).then(e=>e.MenuView));class re extends F{unsubscribeSubject=new M;constructor(){super(),Z.state$.pipe(H(this.unsubscribeSubject)).subscribe(t=>this.setState({gameState:t}))}componentWillUnmount(){this.unsubscribeSubject.next()}render(t,{gameState:s}){return l("div",{class:"c-app"},l(G.Provider,{value:s},l($,{fallback:l("div",{class:"page-loading"})},l(U,{history:k()},l(ee,{path:_.Game}),l(te,{path:_.Highscores}),l(se,{path:_.About}),l(ne,{path:_.Home})))))}componentDidMount(){Promise.all([u(()=>import("./game-view-ntBVl9sU.js"),__vite__mapDeps([0,1,2,3])),u(()=>import("./highscores-view-A4Zq-Rs2.js"),__vite__mapDeps([4,1,2,3])),u(()=>import("./about-view-9X0Thvtk.js"),__vite__mapDeps([5,1,3])),u(()=>import("./menu-view-x9p04cmp.js"),__vite__mapDeps([6,1,3]))]).catch(t=>console.error(t))}}const ie=(e,t)=>{const s=e[t];return s?typeof s=="function"?s():Promise.resolve(s):new Promise((o,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+t)))})},v=new Map,P="icon-name";class oe extends HTMLElement{static observedAttributes=[P];constructor(){super()}attributeChangedCallback(t,s,o){t===P&&this.setIcon(o)}setIcon(t){typeof t!="string"||t.length===0||this.getIcon(t).then(s=>{this.innerHTML=s})}async getIcon(t){if(!v.has(t)){const{default:o}=await ie(Object.assign({"./svg-icons/github.ts":()=>u(()=>import("./github-2IFn9t5S.js"),__vite__mapDeps([])),"./svg-icons/moon.ts":()=>u(()=>import("./moon-2H6ZF6GE.js"),__vite__mapDeps([])),"./svg-icons/sun.ts":()=>u(()=>import("./sun-W9U8S791.js"),__vite__mapDeps([]))}),`./svg-icons/${t}.ts`);v.set(t,o)}return v.get(t)}}document.documentElement.classList.remove("page-loading");customElements.define("svg-icon",oe);K(l(re,null),document.body);export{_ as A,C as D,A as G,Z as a,g as b,W as c,E as d,S as e,G as g};
//# sourceMappingURL=index-9tt11mSy.js.map
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/game-view-ntBVl9sU.js","assets/vendor-tJNv_qKg.js","assets/highscores-table-pPJCsCgP.js","assets/icon-name.enum-0ePiKs41.js","assets/highscores-view-A4Zq-Rs2.js","assets/about-view-9X0Thvtk.js","assets/menu-view-x9p04cmp.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}